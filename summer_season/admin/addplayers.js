window.onload=function(){jsFill(),getdata(),localStorage.getItem(ladderSeason+"Ladders_Offered_Computation")||(byId("check").checked=!0)};function getdata(){try{savekey(LZString.decompress(localStorage.getItem(ladderSeason+"admkey")))}catch{}}async function ptc(t,s,e){e&&(t=e+t);const{data,error}=await adsb.client.from(init.f_e+t).select(s);error&&console.log(error);try{executeFunctionByName(thenfunction,window,data)}catch{}return{data,error}}function savekey(k){if(k.length<1)try{k=LZString.decompress(localStorage.getItem(ladderSeason+"admkey"))}catch{}else localStorage.setItem(ladderSeason+"admkey",LZString.compress(k));adsb.client=supabase.createClient(init.f_u,k)}function getavlb(tb){ptc(tb,"*").then(function(res){avbl=res,avbl2.round=[[],[],[],[],[],[],[],[],[]];for(let i=0;i<res.length;i++)avbl2.round[res[i].round].push(res[i]);dspavlb()})}function dspavlb(){let round=byId("round").value,rarr=avbl2.round[round];byId("output").value="";for(let i=0;i<rarr.length;i++){console.log(rarr[i]);let dl=`
`;byId("delimit").value.length>0&&(dl=byId("delimit").value),byId("output").value+=rarr[i].name.trim()+dl}}function getsbs(tb){ptc(tb,"*").then(function(res){sbs=res,sbs2.round=[[],[],[],[],[],[],[],[],[]];for(let i=0;i<res.length;i++)unundefine(res[i].round)||(res[i].round=0),sbs2.round[res[i].round].push(res[i]);dspsbs()})}function dspsbs(){let round=byId("round2").value,rarr=sbs2.round[round];byId("output2").value="";for(let i=0;i<rarr.length;i++){console.log(rarr[i]);let dl=`
`;byId("delimit").value.length>0&&(dl=byId("delimit").value),byId("output2").value+=rarr[i].name.trim()+dl}}let adsb={},avbl={},avbl2={},sbs={},sbs2={},currnttb={};function gettable(tn){ptc(tn,"*").then(function(res){if(!res)return!1;byId("table").innerHTML="",currnttb=res,console.log(res);let thr=document.createElement("tr");for(let i=0;i<Object.keys(res[0]).length;i++){let ky=Object.keys(res[0])[i],th=document.createElement("th");th.innerHTML=ky,thr.appendChild(th)}byId("table").appendChild(thr);for(let i=0;i<res.length;i++){let tr=document.createElement("tr");for(let ij=0;ij<Object.values(res[i]).length;ij++){let ky=Object.values(res[i])[ij],yk=Object.keys(res[i])[ij];byId("cvtime").checked&&yk=="created_at"&&Boolean(new Date(ky)!="Invalid Date")&&(ky=new Date(ky).toString());let td=document.createElement("td");td.innerHTML=ky,tr.appendChild(td)}byId("table").appendChild(tr)}})}function jsFill(){try{let hy=byAttr("jsfill");for(let i=0;i<hy.length;i++){let jf;jf=Boolean(hy[i].getAttribute("jsfill"))?hy[i].getAttribute("jsfill"):"";try{typ=jf.split("?")[1],jf=jf.split("?")[0],typ.length>0?hy[i][typ]=eval(jf):hy[i].innerHTML=eval(jf)}catch{}}}catch{}}function addplayers(val){let ldv={Open:{sb:""},Womens:{sb:"womens-ladder_"}};byId("check").checked||(val=localStorage.getItem(ladderSeason+"Ladders_Offered_Computation"));let h=JSON.parse(val),nhf=prompt("Ladders to save (csv)").split(",");for(let mni=0;mni<Object.keys(h).length;mni++){var ld=Object.keys(h)[mni],bh=h[ld].signups;let awiaf=[],awiaf2=[],awiaf3=[];for(let i=0;i<bh.length;i++){let fnam=bh[i].first_name.trim().toLowerCase(),lnam=bh[i].last_name.trim().toLowerCase(),nam=bh[i].username.toLowerCase().replace(/(\s)/g,""),skey=bh[i].secret_key;try{LZString.decompressFromBase64(skey)&&(skey=LZString.decompressFromBase64(skey))}catch{}let cmbin=nam+skey,hsh=sha256(cmbin);awiaf.push(hsh),awiaf2.push(sha256(hsh)),console.log(fnam+" "+lnam+": "+ld+`
`+sha256(cmbin));let gc=(fnam+lnam).replace(/(\s)/g,""),cph=cipher("limit");awiaf3.push(cph(gc));let ins={hash:hsh,bwoc:nam},tb="identities";if(nhf.includes(ld)){console.log(tb,ins,ldv[ld].sb),adsaveData(tb,ins,ldv[ld].sb),console.log(`${gc}: ${cph(gc)}`);let ins2={afaf:cph(gc),bool:!0};adsaveData("pard",ins2,ldv[ld].sb);let mno={list:awiaf2};console.log(mno),adupdateData("rdbusrs",mno,"id",1,ldv[ld].sb);let contact={name:`${bh[i].first_name} ${bh[i].last_name}`,email:bh[i].email,phone:bh[i].phone,prefer:bh[i].prefer,common:1,emailx:bh[i].emailx};console.log(contact),adsaveData("contact",contact,ldv[ld].sb)}}}}function spreadsheetify(){let nb=JSON.parse(localStorage.getItem(ladderSeason+"Ladders_Offered_Computation")),nt=["created_at","username","first_name","last_name","email","phone","prefer","have_read","0","DUPR","0","0","Self_Rating","payment_method","PayPal_name","0"],ld=byId("ladder").value;if(ld.length<1)return alert("Invalid Ladder"),!1;let hg=nb[ld].signups;console.log(hg);let ce=document.createElement("textarea");ce.setAttribute("hidden",""),document.body.appendChild(ce);for(let ix=0;ix<hg.length;ix++){let snp=hg[ix],vf=Object.keys(snp),st="";for(let i=0;i<nt.length;i++){let h=nt[i];vf.includes(h)&&snp[h]!=null?st+=snp[h]+",":st+=","}ce.value+=st+`
`}navigator.clipboard.writeText(ce.value);let al=document.createElement("a");al.innerHTML="Test Spreadsheet",al.href="javascript:;",al.target="_blank",al.rel="noreferrer",al.onclick=function(){window.open("https://calc.domainepublic.net/ninnisonue93n9mMNDicw9csd9ckMwc","_blank")},document.body.appendChild(al)}async function adsaveData(t,e,th){th&&(t=th+t);const{data,error}=await adsb.client.from(init.f_e+t).insert([e]);return error&&console.log(error),{data,error}}async function adupdateData(t,e,s,m,th){th&&(t=th+t);const{data,error}=await adsb.client.from(init.f_e+t).update([e]).eq(s,m);return error&&console.log(error),{data,error}}async function addelete(t){confirm(`Are you sure you want to delete the entire table ${t}?`),confirm("Are you really sure?"),confirm("This cannot be undone"),confirm("Proceed?");const{data,error}=await adsb.client.from(init.f_e+t).delete()}function updatePaymentTable(boolean){let ldv={Open:{sb:""},Womens:{sb:"womens-ladder_"}},ladder=prompt("Which ladder is this for?");notPaidArray=byId(Boolean(boolean)?"paid":"notpaid").value.trim().split(`
`),console.log(notPaidArray);for(let i=0;i<notPaidArray.length;i++){const player=notPaidArray[i];let gc=player.replace(/(\s)/g,"").toLowerCase(),cph=cipher("limit");console.log(`${gc}: ${cph(gc)}`);let json={afaf:cph(gc),bool:boolean};adupdateData("pard",json,"afaf",cph(gc),ldv[ladder].sb)}}